% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ohseer_ocr.R
\name{ohseer_ocr}
\alias{ohseer_ocr}
\title{Unified OCR Interface for Multiple Providers with Automatic Fallback}
\usage{
ohseer_ocr(
  file_path,
  provider = c("tensorlake", "mistral", "claude"),
  pages = NULL,
  timeout = 60,
  extract_pages = TRUE,
  ...
)
}
\arguments{
\item{file_path}{Character string. Path to the PDF file to process.}

\item{provider}{Character vector. OCR provider(s) to use. Can be a single provider
or multiple providers for automatic fallback. Valid values:
\describe{
\item{"tensorlake"}{Tensorlake OCR API (default) - Highest accuracy (91.7\\%)}
\item{"mistral"}{Mistral OCR 3 - Lower cost, native markdown format}
\item{"claude"}{Claude Opus/Sonnet - Structured outputs with JSON schema}
}
When multiple providers are specified, they will be tried sequentially until
one succeeds. Default is \code{c("tensorlake")}.}

\item{pages}{Integer vector. Specific page numbers to process. If NULL (default),
processes all pages. Page numbers are 1-based.}

\item{timeout}{Numeric. Maximum wait time in seconds for OCR processing.
Default is 60 seconds. Not used for Claude provider.}

\item{extract_pages}{Logical. If TRUE (default), automatically extracts and
returns page data using provider-specific extraction functions. If FALSE,
returns raw API response.}

\item{...}{Additional provider-specific arguments passed to the underlying
OCR function:
\describe{
\item{Tensorlake}{\code{model}, \code{use_cache}, etc.}
\item{Mistral}{\code{extract_header}, \code{extract_footer}, \code{table_format}, etc.}
\item{Claude}{\code{model}, \code{max_tokens}, \code{dpi}, \code{schema}, etc.}
}}
}
\value{
If \code{extract_pages = TRUE} (default), returns a list with:
\describe{
\item{provider}{Character string naming the provider that succeeded}
\item{pages}{List of extracted page data (structure varies by provider)}
\item{raw}{Raw API response (for advanced use)}
\item{error_log}{Character string (JSON) of failed attempts, or NA if first provider succeeded}
}

If \code{extract_pages = FALSE}, returns the raw provider API response.
}
\description{
A unified wrapper function that provides a consistent interface across different
OCR providers (Tensorlake, Mistral, Claude). This function normalizes parameter
names and return structures, making it easier to switch between providers or
implement provider fallback logic.
}
\section{Provider-Specific Output Formats}{


Each provider returns pages in a different native format:

\strong{Tensorlake} - Structured fragments:
\itemize{
\item \code{page_number}: Integer (1-based)
\item \code{page_fragments}: List of content fragments with type, content, reading_order
}

\strong{Mistral} - Native markdown format:
\itemize{
\item \code{index}: Integer (0-based)
\item \code{markdown}: Full page content
\item \code{tables}: Array of table objects
\item \code{header}, \code{footer}: Separate header/footer fields
}

\strong{Claude} - Structured output (Tensorlake-compatible by default):
\itemize{
\item \code{page_number}: Integer (1-based)
\item \code{page_fragments}: List of content fragments
\item Custom schema can be provided via \code{schema} argument
}
}

\section{Provider Fallback}{


When multiple providers are specified, they are tried sequentially until one succeeds:

\preformatted{
# Try Mistral first (lower cost), fall back to Tensorlake (higher quality)
result <- ohseer_ocr("document.pdf", provider = c("mistral", "tensorlake"))

# Try Tensorlake first (higher quality), fall back to Mistral (lower cost)
result <- ohseer_ocr("document.pdf", provider = c("tensorlake", "mistral"))

# Check which provider succeeded
message("Used provider: ", result$provider)

# Check error log if any providers failed
if (!is.na(result$error_log)) {
  errors <- jsonlite::fromJSON(result$error_log)
  print(errors)
}
}
}

\examples{
\dontrun{
# Basic usage with default provider (Tensorlake)
result <- ohseer_ocr("document.pdf")

# Use Mistral OCR with header/footer extraction
result <- ohseer_ocr(
  "document.pdf",
  provider = "mistral",
  extract_header = TRUE,
  extract_footer = TRUE
)

# Use Claude with custom model and page selection
result <- ohseer_ocr(
  "document.pdf",
  provider = "claude",
  pages = c(1, 2),
  model = "claude-sonnet-4-5"
)

# Provider fallback: try Mistral first, fall back to Tensorlake
result <- ohseer_ocr("document.pdf", provider = c("mistral", "tensorlake"))

# Quality-first: try Tensorlake first, fall back to Mistral
result <- ohseer_ocr("document.pdf", provider = c("tensorlake", "mistral"))

# Full fallback chain
result <- ohseer_ocr(
  "document.pdf",
  provider = c("tensorlake", "mistral", "claude")
)

# Access results
pages <- result$pages
provider_used <- result$provider
}

}
\seealso{
Provider-specific functions:
\itemize{
\item \code{\link{tensorlake_ocr}}, \code{\link{tensorlake_extract_pages}}
\item \code{\link{mistral_ocr}}, \code{\link{mistral_extract_pages}}
\item \code{\link{claude_ocr_process_file}}, \code{\link{claude_extract_pages}}
}
}
\author{
Nathan C. Layman
}
